---
title: JavaScript函数定义&立即执行
date: 2018-09-07 11:23:25
categories: 个人整理
tags: 
- JavaScript
- 函数
---
想要理解立即执行函数，首先需要知道一些函数的基本概念，以下整理了函数定义的方法和立即执行函数的方法。
## 定义函数
在JavaScript中定义函数一般有三种方法,分别是：函数声明、函数表达式，又叫函数字面量和Function()构造函数。
### 1.函数声明
```js
function sum(x, y) {
    return x + y;
}
```
使用function关键字声明一个函数，再指定一个函数名，叫函数声明。
### 2.函数表达式
```js
var sum = function (x, y) {
    return x + y;
};
```
使用function关键字声明一个函数，但未给函数命名，最后将匿名函数赋予一个变量，叫函数表达式。

但是需要注意的是，这种将匿名函数赋值的方法，调用函数需要在赋值之后，比如：
```js
var sum = function (x, y) {
    return x + y;
};
console.log(sum(2,3));//5
```
如果是在将匿名函数赋值给变量之前就调用：
```js
console.log(sum(1,2));
var sum = function (x, y) {
    return x + y;
};
```
像这样子，便会出现`TypeError: sum is not a function`错误
### 3.Function()构造函数
```js
var sum = new Function('x', 'y', 'return x+y;');
```
由Function构造函数的参数个数可变。最后一个参数写函数体，前面的参数写入参。
当然，如果函数没有传入的参数，就只要在Function函数中传入函数体就可以了。
```js
var hello=new Function('console.log("hello");');
hello();//hello
```
但是这样子定义函数用起来不是很方便，我也没有怎么使用过这种方法定义函数，最主要的还是前两种方法来定义函数。
## 立即执行函数
三种定义函数的方法介绍之后，就是介绍立即执行函数。立即执行函数常用于第三方库，好处在于隔离作用域，任何一个第三方库都会存在大量的变量和函数，为了避免变量污染（命名冲突），开发者们想到的解决办法就是使用立即执行函数。
### 1.(function () {…})()和(function () {…}())
立即执行函数有两种常见形式：(function () {…})()和(function () {…}())，一个是一个匿名函数包裹在一个括号运算符中，后面再跟一个小括号，另一个是一个匿名函数后面跟一个小括号，然后整个包裹在一个括号运算符中，这两种写法是等价的。
### 2.立即执行函数的注意点
- **一是函数体后面要有小括号()**
- **二是函数体必须是函数表达式而不能是函数声明**
```js
(function (x) {
    console.log(x);
})(1);//1

(function (x) {
    console.log(x);
}(2));//2
```
两种方法都可以立即执行函数，之所以要在函数声明外加上括号，就是为了让**函数声明变成函数表达式**，便可以立即执行该函数了，当然，只要是函数表达式就可以立即执行函数，不一定是用括号，比如：
```js
!function(x){
    console.log(x);//输出1,使用!运算符
}(1);

+function(x){
    console.log(x);//输出2,使用+运算符
}(2);

-function(x){
    console.log(x);//输出3,使用-运算符
}(3);

var f=function(x){
    console.log(x);//输出4，使用=运算符
}(4);

```
除了(),还可以使用!，+，-，=等运算符，都将函数声明转换成函数表达式，消除了javascript引擎识别函数表达式和函数声明的歧义，告诉javascript引擎这是一个函数表达式，不是函数声明，可以在后面加括号，并立即执行函数的代码。
### 3.使用立即执行函数的好处
由于JavaScript中没有私有作用域，但是通过匿名函数，创建了一个新的函数作用域，该函数作用域就相当于私有作用域，在其中定义的变量，是不会像全局变量那样，被其他同名变量覆盖掉，函数中可以使用外部变量，但是外部无法修改函数中的变量。